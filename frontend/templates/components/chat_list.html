<!-- Server-side rendered chat list component -->
{% macro chat_list(chats, is_empty=False) %}
  <div id="chat-list" class="chat-list">
    {% if is_empty %}
      <div class="text-center p-5">
        <div class="text-muted mb-3">
          <i class="fas fa-comments fa-3x"></i>
        </div>
        <p>No chats yet. Start a new conversation!</p>
        <a href="/create" class="btn btn-primary mt-3">
          <i class="fas fa-plus me-2"></i> New Chat
        </a>
      </div>
    {% else %}
      {% for chat in chats %}
        <a href="/chat/{{ chat.chat_id }}" class="chat-list-item {% if chat.unread %}unread{% endif %}" data-chat-id="{{ chat.chat_id }}">
          <div class="d-flex align-items-center py-2">
            <!-- Chat avatar with status indicator -->
            <div class="chat-avatar me-3">
              {% if chat.other_participant and chat.other_participant.profile_image %}
                <img src="{{ chat.other_participant.profile_image }}" alt="{{ chat.display_name }}" class="avatar">
              {% else %}
                <div class="avatar-fallback">
                  {{ chat.display_name[:1] }}
                </div>
              {% endif %}
              
              {% if chat.other_participant %}
                <span class="status-indicator {{ chat.other_participant.status or 'offline' }}"></span>
              {% endif %}
            </div>
            
            <!-- Chat details -->
            <div class="chat-info flex-grow-1">
              <div class="d-flex justify-content-between align-items-start">
                <h3 class="chat-title fs-6 mb-1">{{ chat.display_name }}</h3>
                <small class="chat-time text-muted">{{ chat.last_message.time_formatted if chat.last_message else '' }}</small>
              </div>
              
              <div class="d-flex justify-content-between align-items-center">
                <p class="chat-preview text-truncate mb-0 text-muted">
                  {{ chat.preview.text if chat.preview else 'No messages yet' }}
                </p>
                
                {% if chat.unread %}
                  <span class="badge bg-primary rounded-pill ms-2">New</span>
                {% endif %}
              </div>
            </div>
          </div>
        </a>
      {% endfor %}
    {% endif %}
  </div>
{% endmacro %} 